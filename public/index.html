<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FÃ¶rderFunke</title>
</head>
<body>
    <div id="output"></div>
    <script src="./bundle.js"></script>
    <script>
        let userProfile = `
@prefix ff: <https://foerderfunke.org/default#> .

ff:mainPerson a ff:Citizen ;
    ff:hasAge 24 .
        `

        let shacl = `
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix ff: <https://foerderfunke.org/default#> .

ff:MainPersonShape a sh:NodeShape ;
    sh:targetClass ff:Citizen ;
    sh:property [
        sh:path ff:hasAge ;
        sh:maxExclusive 18 ;
    ] .
        `

        MatchingEngine.validateOne(userProfile, "", "", shacl).then((report) => {
            console.log(report)
            document.getElementById("output").innerHTML = JSON.stringify(report, null, 2)
        })

        async function fetchTextFile(relPath) {
            const response = await fetch(relPath)
            return await response.text()
        }

        async function loadFiles() {
            let turtleContents = {
                "datafields": await fetchTextFile("requirement-profiles/datafields.ttl"),
                "materialization": await fetchTextFile("requirement-profiles/materialization.ttl"),
                "shacl": {}
            }
            let shaclFiles = await fetchTextFile("shacl-files.txt")
            for (let shaclFile of shaclFiles.split("\n")) {
                if (!shaclFile) continue
                turtleContents.shacl[shaclFile] = await fetchTextFile("requirement-profiles/shacl/" + shaclFile)
            }
            return turtleContents
        }

        loadFiles()

    </script>
</body>
</html>
